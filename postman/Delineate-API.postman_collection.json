{
  "info": {
    "_postman_id": "cuet-micro-ops-hackathon-2025",
    "name": "Delineate Hackathon API",
    "description": "# CUET Micro-Ops Hackathon 2025\n\n## Base URL: http://localhost:3000\n\n## ÔøΩ Download API (Original - demonstrates timeout problem)\n- POST /v1/download/initiate - Initiate bulk download\n- POST /v1/download/check - Check file availability\n- POST /v1/download/start - Start download (long-running)\n\n## üöÄ Export Jobs (Challenge 2 Solution - BullMQ + SSE)\n- POST /v1/export/create - Create export job\n- GET /v1/export/status/{jobId} - Poll status\n- GET /v1/export/progress/{jobId} - SSE stream\n- GET /v1/export/download/{jobId} - Presigned URL",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {"key": "baseUrl", "value": "http://localhost:3000", "type": "string"},
    {"key": "exportJobId", "value": "", "type": "string"}
  ],
  "item": [
    {
      "name": "General",
      "item": [
        {
          "name": "Health Check",
          "request": {"method": "GET", "url": {"raw": "{{baseUrl}}/health", "host": ["{{baseUrl}}"], "path": ["health"]}}
        },
        {
          "name": "Prometheus Metrics",
          "request": {"method": "GET", "url": {"raw": "{{baseUrl}}/metrics", "host": ["{{baseUrl}}"], "path": ["metrics"]}}
        },
        {
          "name": "OpenAPI Spec",
          "request": {"method": "GET", "url": {"raw": "{{baseUrl}}/openapi", "host": ["{{baseUrl}}"], "path": ["openapi"]}}
        }
      ]
    },
    {
      "name": "Download API (Original)",
      "description": "Original download endpoints that demonstrate the timeout problem. These have long processing delays (10-120s) that can cause timeouts behind proxies like Cloudflare.",
      "item": [
        {
          "name": "Download Initiate",
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"file_ids\": [10000, 20000, 30000]}"},
            "url": {"raw": "{{baseUrl}}/v1/download/initiate", "host": ["{{baseUrl}}"], "path": ["v1", "download", "initiate"]},
            "description": "Initiates a download job for multiple file IDs. Returns a job ID."
          }
        },
        {
          "name": "Download Check",
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"file_id\": 70000}"},
            "url": {"raw": "{{baseUrl}}/v1/download/check", "host": ["{{baseUrl}}"], "path": ["v1", "download", "check"]},
            "description": "Check if a single file is available in S3. Add ?sentry_test=true to test Sentry error tracking."
          }
        },
        {
          "name": "Download Start (Long-Running)",
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"file_id\": 70000}"},
            "url": {"raw": "{{baseUrl}}/v1/download/start", "host": ["{{baseUrl}}"], "path": ["v1", "download", "start"]},
            "description": "‚ö†Ô∏è LONG-RUNNING: Starts a download with 10-120s delay. May timeout! This demonstrates the problem that Challenge 2 solves."
          }
        }
      ]
    },
    {
      "name": "Export Jobs (Challenge 2 Solution)",
      "description": "Background job processing for file exports with real-time progress via SSE. This solves the timeout problem from the Download API.",
      "item": [
        {
          "name": "1. Create Export Job",
          "event": [{"listen": "test", "script": {"exec": ["var data = pm.response.json();", "if (data.jobId) pm.collectionVariables.set('exportJobId', data.jobId);"], "type": "text/javascript"}}],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"file_ids\": [10000, 20000, 30000], \"user_id\": \"user-123\"}"},
            "url": {"raw": "{{baseUrl}}/v1/export/create", "host": ["{{baseUrl}}"], "path": ["v1", "export", "create"]}
          }
        },
        {
          "name": "2. Get Export Status",
          "request": {"method": "GET", "url": {"raw": "{{baseUrl}}/v1/export/status/{{exportJobId}}", "host": ["{{baseUrl}}"], "path": ["v1", "export", "status", "{{exportJobId}}"]}}
        },
        {
          "name": "3. SSE Progress Stream",
          "request": {
            "method": "GET",
            "header": [{"key": "Accept", "value": "text/event-stream"}],
            "url": {"raw": "{{baseUrl}}/v1/export/progress/{{exportJobId}}", "host": ["{{baseUrl}}"], "path": ["v1", "export", "progress", "{{exportJobId}}"]}
          }
        },
        {
          "name": "4. Get Download URL",
          "request": {"method": "GET", "url": {"raw": "{{baseUrl}}/v1/export/download/{{exportJobId}}", "host": ["{{baseUrl}}"], "path": ["v1", "export", "download", "{{exportJobId}}"]}}
        }
      ]
    }
  ]
}
